Je comprends ðŸ˜“
Pas de panique â€” voici uniquement les lignes Ã  modifier (rien dâ€™autre).

Dans ton app.py, dans la fonction disconnect() :

ðŸ”´ Remplace les 4 premiÃ¨res lignes de la fonction
(celles qui commencent juste aprÃ¨s def disconnect():)
par ces 6 lignes :

username = ""
    data = {}

    try:
        if request.data:
            data = json.loads(request.data.decode("utf-8"))
    except Exception as e:
        app.logger.warning(f"[disconnect] JSON invalide: {e}")

    username = (data.get("user") or "").strip().lower()
    req_type = (data.get("type") or "").lower()

âœ… Ne touche Ã  rien dâ€™autre dans le reste du bloc.
Ã‡a suffit pour Ã©viter lâ€™erreur "username not defined" sans rien casser du reste.

